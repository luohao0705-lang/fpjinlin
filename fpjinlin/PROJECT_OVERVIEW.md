# 复盘精灵系统 - 项目概览

## 🎯 项目完成状态

✅ **数据库设计** - 完整的9张表结构，支持用户、订单、兑换码、配置管理  
✅ **用户注册/登录系统** - 手机短信验证，安全的会话管理  
✅ **文件上传功能** - 支持截图、封面上传，完整的文件管理  
✅ **AI分析集成** - DeepSeek API集成，智能分析报告生成  
✅ **报告展示系统** - 专业报告展示，支持图片/PDF导出  
✅ **后台管理系统** - 完整的管理员后台，用户/订单/兑换码管理  
✅ **兑换码系统** - 批量生成、使用追踪、统计分析  

## 🚀 快速开始

### 1. 安装部署

```bash
# 1. 访问安装页面
http://your-domain.com/install.php

# 2. 按照向导完成安装
# 3. 配置Web服务器指向项目根目录
# 4. 设置uploads目录权限
chmod -R 755 assets/uploads/
```

### 2. 系统配置

登录管理后台 (admin/admin123) 配置：

- **DeepSeek API**: 设置API密钥启用AI分析
- **阿里云SMS**: 配置短信服务参数
- **系统参数**: 调整分析费用、文件限制等

### 3. 开始使用

- **前台地址**: `/pages/user/login.php`
- **后台地址**: `/admin/login.php`

## 📋 核心功能详解

### 🔐 用户系统
- 手机号注册/登录（短信验证）
- 安全的密码加密存储
- 精灵币余额管理
- 交易记录追踪

### 📊 分析订单系统
- 创建分析订单（话术+截图+封面）
- 文件上传管理（支持拖拽、预览）
- 订单状态跟踪（待处理/处理中/已完成/失败）
- 自动扣费和退款机制

### 🤖 AI分析引擎
- **DeepSeek API集成**: 专业的AI对话模型
- **智能提示词**: 结构化的分析要求
- **多维度分析**: 综合评分、优劣势、改进建议
- **同行对比**: 竞争对手话术对比分析
- **数据洞察**: 基于截图的数据分析

### 📈 分析报告系统
- **专业报告展示**: 评分、等级、详细分析
- **可视化图表**: Chart.js图表展示
- **多格式导出**: PDF、图片、链接分享
- **响应式设计**: 支持移动端查看

### 💰 兑换码系统
- **批量生成**: 支持不同面值、数量、过期时间
- **使用追踪**: 详细的使用记录和统计
- **批次管理**: 按批次组织，便于管理和导出
- **安全验证**: 防重复使用、过期检查

### 🛠️ 后台管理系统
- **仪表盘**: 实时数据统计和图表展示
- **用户管理**: 用户列表、状态管理、余额调整
- **订单管理**: 订单监控、重新分析、详情查看
- **兑换码管理**: 生成、查看、导出、删除
- **系统设置**: API配置、参数调整
- **操作日志**: 完整的管理员操作记录

## 🔧 技术架构

### 后端架构
```
PHP 7.4 (面向对象设计)
├── 配置层 (config/)
│   ├── 数据库连接管理
│   ├── 系统参数配置
│   └── 安全设置
├── 业务层 (includes/)
│   ├── User.php - 用户管理
│   ├── AnalysisOrder.php - 订单管理
│   ├── ExchangeCode.php - 兑换码管理
│   ├── Admin.php - 管理员管理
│   └── AIAnalyzer.php - AI分析引擎
├── 接口层 (api/)
│   ├── 短信发送接口
│   └── AI分析处理接口
└── 页面层 (pages/, admin/)
    ├── 用户前台页面
    └── 管理后台页面
```

### 前端架构
```
Bootstrap 5 + 原生JavaScript
├── 响应式UI设计
├── 交互式表单验证
├── 文件上传（拖拽支持）
├── 图表可视化 (Chart.js)
├── PDF/图片导出 (jsPDF + html2canvas)
└── 移动端适配
```

### 数据库设计
```
MySQL 5.7+ (9张核心表)
├── 用户相关: users, sms_codes, coin_transactions
├── 订单相关: analysis_orders, order_screenshots  
├── 兑换码: exchange_codes
├── 管理相关: admins, admin_logs
└── 系统配置: system_configs
```

## 🔒 安全特性

- **SQL注入防护**: PDO预处理语句
- **XSS防护**: 输出转义处理
- **CSRF防护**: 表单令牌验证
- **文件上传安全**: 类型验证、大小限制
- **密码安全**: bcrypt加密存储
- **会话安全**: 安全的会话配置
- **API安全**: 密钥管理、请求验证

## 📱 移动端支持

- 响应式设计，完美适配手机端
- 触摸友好的交互界面
- 移动端优化的文件上传
- 适配小屏幕的报告展示

## 🔄 扩展性设计

### 已预留扩展点
- **队列系统**: 可集成Redis队列处理AI分析
- **缓存系统**: 可添加Redis缓存提升性能
- **OSS存储**: 可配置阿里云OSS存储文件
- **CDN加速**: 可配置CDN加速静态资源
- **支付集成**: 可扩展在线支付功能
- **微信集成**: 可添加微信授权登录

### 性能优化
- 数据库索引优化
- 静态资源缓存
- Gzip压缩
- 图片懒加载
- 分页查询

## 📊 监控与维护

### 系统监控
- 订单处理状态监控
- API调用成功率统计
- 用户活跃度分析
- 错误日志记录

### 维护工具
- 定时分析脚本
- 数据库备份建议
- 日志清理策略
- 性能监控建议

## 🎨 UI/UX设计亮点

- **现代化设计**: 渐变色彩、圆角设计、阴影效果
- **直观的操作流程**: 步骤指示器、进度显示
- **友好的用户反馈**: 成功/错误提示、加载状态
- **专业的报告展示**: 评分可视化、结构化内容
- **便捷的操作**: 一键复制、拖拽上传、快捷导出

## 🚦 部署检查清单

### 生产环境部署前
- [ ] 关闭错误显示 (`display_errors = 0`)
- [ ] 配置DeepSeek API密钥
- [ ] 配置阿里云SMS服务
- [ ] 设置文件上传权限
- [ ] 配置SSL证书（HTTPS）
- [ ] 设置定时任务（可选）
- [ ] 数据库备份策略
- [ ] 监控和日志策略

### 安全加固
- [ ] 修改默认管理员密码
- [ ] 删除install.php文件
- [ ] 配置防火墙规则
- [ ] 设置文件权限
- [ ] 配置Web服务器安全头部

## 📞 技术支持

### 常见问题解决
1. **AI分析失败**: 检查API配置和网络连接
2. **短信发送失败**: 检查阿里云SMS配置
3. **文件上传失败**: 检查目录权限和文件大小限制
4. **登录问题**: 检查会话配置和数据库连接

### 开发调试
- 错误日志位置: PHP错误日志 + 自定义日志
- 开发模式: 修改config.php中的错误报告设置
- 数据库调试: 开启PDO错误模式

---

**项目版本**: v1.0.0  
**开发完成**: 2024年  
**技术栈**: PHP 7.4 + MySQL + Bootstrap 5  
**核心特性**: AI分析 + 兑换码系统 + 完整管理后台